<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  
  
  <title>测试的基本规则和流程 | WHT</title>
  
  <meta name="author" content="王贺天" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="Go语言" />
  
  <meta name="description" content="对于程序或软件的测试也分很多种，比如：单元测试、API 测试、集成测试、灰度测试，等等。在篇会主要针对单元测试进行讲解。 &amp;nbsp; 单元测试的类别&amp;nbsp;单元测试，它又称程序员测试。顾名思义，这就是程序员们本该做的自我检查工作之一。&amp;nbsp;Go 语言的缔造者们从一开始就非常重视程序测试，并且为 Go 程序的开发者们提供了丰富的 API 和工具。利用这些 API 和工具，我们可以创建测试">
<meta property="og:type" content="article">
<meta property="og:title" content="测试的基本规则和流程">
<meta property="og:url" content="http://wht6.github.io/posts/cd2d.html">
<meta property="og:site_name" content="WHT">
<meta property="og:description" content="对于程序或软件的测试也分很多种，比如：单元测试、API 测试、集成测试、灰度测试，等等。在篇会主要针对单元测试进行讲解。 &amp;nbsp; 单元测试的类别&amp;nbsp;单元测试，它又称程序员测试。顾名思义，这就是程序员们本该做的自我检查工作之一。&amp;nbsp;Go 语言的缔造者们从一开始就非常重视程序测试，并且为 Go 程序的开发者们提供了丰富的 API 和工具。利用这些 API 和工具，我们可以创建测试">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/wht6/image/master/img/benchmark_202235.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wht6/image/master/img/count_202235.png">
<meta property="article:published_time" content="2021-05-22T02:00:00.000Z">
<meta property="article:modified_time" content="2022-04-02T08:39:12.975Z">
<meta property="article:author" content="王贺天">
<meta property="article:tag" content="Go语言">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wht6/image/master/img/benchmark_202235.png">
  <link rel="alternate" href="atom.xml" type="application/atom+xml">
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
    
  </style>
  
<style type="text/css" lang="css">
    #loading-container{
        position: fixed;
        top: 0;
        left: 0;
        min-height: 100vh;
        width: 100vw;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: #FFF;
        text-align: center;
        /* loader页面消失采用渐隐的方式*/
        -webkit-transition: opacity 1s ease;
        -moz-transition: opacity 1s ease;
        -o-transition: opacity 1s ease;
        transition: opacity 1s ease;
    }
    .loading-image{
        width: 120px;
        height: 50px;
        transform: translate(-50%);
    }
    
    .loading-image div:nth-child(2) {
        -webkit-animation: pacman-balls 1s linear 0s infinite;
        animation: pacman-balls 1s linear 0s infinite
    }

    .loading-image div:nth-child(3) {
        -webkit-animation: pacman-balls 1s linear .33s infinite;
        animation: pacman-balls 1s linear .33s infinite
    }

    .loading-image div:nth-child(4) {
        -webkit-animation: pacman-balls 1s linear .66s infinite;
        animation: pacman-balls 1s linear .66s infinite
    }

    .loading-image div:nth-child(5) {
        -webkit-animation: pacman-balls 1s linear .99s infinite;
        animation: pacman-balls 1s linear .99s infinite
    }
    
   .loading-image div:first-of-type {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_up .5s 0s infinite;
        animation: rotate_pacman_half_up .5s 0s infinite;
    }
    .loading-image div:nth-child(2) {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_down .5s 0s infinite;
        animation: rotate_pacman_half_down .5s 0s infinite;
        margin-top: -50px;
    }
    @-webkit-keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @-webkit-keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}

    @keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}
    
    @-webkit-keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}

    @keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}
    
   
    .loading-image div:nth-child(3),
    .loading-image div:nth-child(4),
    .loading-image div:nth-child(5),
    .loading-image div:nth-child(6){
        background-color: #49b1f5;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        margin: 2px;
        width: 10px;
        height: 10px;
        position: absolute;
        transform: translateY(-6.25px);
        top: 25px;
        left: 100px;
    }
    .loading-text{
        margin-bottom: 20vh;
        text-align: center;
        color: #2c3e50;
        font-size: 2rem;
        box-sizing: border-box;
        padding: 0 10px;
        text-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    @media only screen and (max-width: 500px) {
         .loading-text{
            font-size: 1.5rem;
         }
    }
    .fadeout {
        opacity: 0;
        filter: alpha(opacity=0);
    }
    /* logo出现动画 */
    @-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}
    @keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);}}
 </style>
 <script>
(function () {
    const loaded = function(){
       setTimeout(function(){
            const loader = document.getElementById("loading-container");
            loader.className="fadeout" ;//使用渐隐的方法淡出loading page
            // document.getElementById("body-wrap").style.display="flex";
            setTimeout(function(){
                loader.style.display="none";
            },1000); 
        },1000);//强制显示loading page 1s  
    };
    loaded();
})()
 </script><meta name="generator" content="Hexo 5.4.0"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                        <li>
                                            
                                                <a href="/">
                                            
                                                
                                                    <i class="fa fa-home"></i>
                                                
                                                首页
                                            </a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="/archives/">
                                            
                                                
                                                    <i class="fa fa-file"></i>
                                                
                                                档案馆
                                            </a>
                                            
                                        </li>
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">WHT</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>WHT</h2> <br />
                        <span>Be Water My Friend</span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="http://wht6.github.io/posts/cd2d.html">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">测试的基本规则和流程</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2021-05-22T02:00:00.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2021-05-22</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">王贺天</span>
                </li>
                
                    <li>
                        <i class="fa fa-edit"></i> 
                        
                        
                            ~10.79K
                        
                        字
                    </li>
                
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>本文最后编辑于 <time datetime="1648888752975"></time> 前，其中的内容可能需要更新。</p></div>
            </div>
            
            
            
            <hr />
            <div itemprop="articleBody"><p>对于程序或软件的测试也分很多种，比如：单元测试、API 测试、集成测试、灰度测试，等等。在篇会主要针对单元测试进行讲解。</p>
<p>&nbsp;</p>
<h3 id="单元测试的类别"><a href="#单元测试的类别" class="headerlink" title="单元测试的类别"></a>单元测试的类别</h3><p>&nbsp;<br>单元测试，它又称程序员测试。顾名思义，这就是程序员们本该做的自我检查工作之一。<br>&nbsp;<br>Go 语言的缔造者们从一开始就非常重视程序测试，并且为 Go 程序的开发者们提供了丰富的 API 和工具。利用这些 API 和工具，我们可以创建测试源码文件，并为命令源码文件和库源码文件中的程序实体，编写测试用例。<br>&nbsp;<br>在 Go 语言中，一个测试用例往往会由一个或多个测试函数来代表，不过在大多数情况下，每个测试用例仅用一个测试函数就足够了。测试函数往往用于描述和保障某个程序实体的某方面功能，比如，该功能在正常情况下会因什么样的输入，产生什么样的输出，又比如，该功能会在什么情况下报错或表现异常，等等。<br>&nbsp;<br>我们可以为 Go 程序编写三类测试，即：功能测试（test）、基准测试（benchmark，也称性能测试），以及示例测试（example）。<br>&nbsp;<br>对于前两类测试，从名称上你就应该可以猜到它们的用途。而示例测试严格来讲也是一种功能测试，只不过它更关注程序打印出来的内容。<br>&nbsp;<br>一般情况下，一个测试源码文件只会针对于某个命令源码文件，或库源码文件（以下简称被测源码文件）做测试，所以我们总会（并且应该）把它们放在同一个代码包内。<br>&nbsp;</p>
<p>测试源码文件的主名称应该以被测源码文件的主名称为前导，并且必须以“_test”为后缀。例如，如果被测源码文件的名称为 demo52.go，那么针对它的测试源码文件的名称就应该是 demo52_test.go。</p>
<p>&nbsp;</p>
<p>每个测试源码文件都必须至少包含一个测试函数。并且，从语法上讲，每个测试源码文件中，都可以包含用来做任何一类测试的测试函数，即使把这三类测试函数都塞进去也没有问题。我通常就是这么做的，只要把控好测试函数的分组和数量就可以了。<br>&nbsp;<br>我们可以依据这些测试函数针对的不同程序实体，把它们分成不同的逻辑组，并且，利用注释以及帮助类的变量或函数来做分割。同时，我们还可以依据被测源码文件中程序实体的先后顺序，来安排测试源码文件中测试函数的顺序。<br>&nbsp;<br>此外，不仅仅对测试源码文件的名称，对于测试函数的名称和签名，Go 语言也是有明文规定的。<br>&nbsp;<br><strong>Go 语言对测试函数的名称和签名都有哪些规定？</strong><br>&nbsp;</p>
<ul>
<li>对于功能测试函数来说，其名称必须以<code>Test</code>为前缀，并且参数列表中只应有一个<code>*testing.T</code>类型的参数声明。</li>
<li>对于性能测试函数来说，其名称必须以<code>Benchmark</code>为前缀，并且唯一参数的类型必须是<code>*testing.B</code>类型的。</li>
<li>对于示例测试函数来说，其名称必须以<code>Example</code>为前缀，但对函数的参数列表没有强制规定。</li>
</ul>
<p>&nbsp;<br>首先需要记住一点，只有测试源码文件的名称对了，测试函数的名称和签名也对了，当我们运行<code>go test</code>命令的时候，其中的测试代码才有可能被运行。</p>
<p>&nbsp;<br><code>go test</code>命令在开始运行时，会先做一些准备工作，比如，确定内部需要用到的命令，检查我们指定的代码包或源码文件的有效性，以及判断我们给予的标记是否合法，等等。<br>&nbsp;<br>在准备工作顺利完成之后，<code>go test</code>命令就会针对每个被测代码包，依次地进行构建、执行包中符合要求的测试函数，清理临时文件，打印测试结果。这就是通常情况下的主要测试流程。<br>&nbsp;<br>请注意上述的“依次”二字。对于每个被测代码包，<code>go test</code>命令会串行地执行测试流程中的每个步骤。<br>&nbsp;<br>但是，为了加快测试速度，它通常会并发地对多个被测代码包进行功能测试，只不过，在最后打印测试结果的时候，它会依照我们给定的顺序逐个进行，这会让我们感觉到它是在完全串行地执行测试流程。<br>&nbsp;<br>另一方面，由于并发的测试会让性能测试的结果存在偏差，所以性能测试一般都是串行进行的。更具体地说，只有在所有构建步骤都做完之后，<code>go test</code>命令才会真正地开始进行性能测试。<br>&nbsp;<br>并且，下一个代码包性能测试的进行，总会等到上一个代码包性能测试的结果打印完成才会开始，而且性能测试函数的执行也都会是串行的。<br>&nbsp;<br>一旦清楚了 Go 程序测试的具体过程，我们的一些疑惑就自然有了答案。比如，那个名叫<code>TestIntroduce</code>的测试函数为什么没执行，又比如，为什么即使是简单的性能测试，执行起来也会比功能测试慢，等等。<br>&nbsp;</p>
<h3 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h3><p>&nbsp;<br><strong>怎样解释功能测试的测试结果？</strong><br>&nbsp;<br>先来看下面的测试命令和结果：<br>&nbsp;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ go test puzzlers&#x2F;article20&#x2F;q2</span><br><span class="line">ok   puzzlers&#x2F;article20&#x2F;q2 0.008s</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>以<code>$</code>符号开头表明此行展现的是我输入的命令。在这里，我输入了<code>go test puzzlers/article20/q2</code>，这表示我想对导入路径为<code>puzzlers/article20/q2</code>的代码包进行测试。代码下面一行就是此次测试的简要结果。</p>
<p>&nbsp;<br>这个简要结果有三块内容。最左边的<code>ok</code>表示此次测试成功，也就是说没有发现测试结果不如预期的情况。<br>&nbsp;<br>当然了，这里全由我们编写的测试代码决定，我们总是认定测试代码本身没有 Bug，并且忠诚地落实了我们的测试意图。在测试结果的中间，显示的是被测代码包的导入路径。<br>&nbsp;<br>而在最右边，展现的是此次对该代码包的测试所耗费的时间，这里显示的<code>0.008s</code>，即 8 毫秒。不过，当我们紧接着第二次运行这个命令的时候，输出的测试结果会略有不同，如下所示：<br>&nbsp;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ go test puzzlers&#x2F;article20&#x2F;q2</span><br><span class="line">ok   puzzlers&#x2F;article20&#x2F;q2 (cached)</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p>可以看到，结果最右边的不再是测试耗时，而是<code>(cached)</code>。这表明，由于测试代码与被测代码都没有任何变动，所以<code>go test</code>命令直接把之前缓存测试成功的结果打印出来了。</p>
<p>&nbsp;<br>go 命令通常会缓存程序构建的结果，以便在将来的构建中重用。我们可以通过运行<code>go env GOCACHE</code>命令来查看缓存目录的路径。缓存的数据总是能够正确地反映出当时的各种源码文件、构建环境、编译器选项等等的真实情况。<br>&nbsp;<br>一旦有任何变动，缓存数据就会失效，go 命令就会再次真正地执行操作。所以我们并不用担心打印出的缓存数据不是实时的结果。go 命令会定期地删除最近未使用的缓存数据，但是，如果你想手动删除所有的缓存数据，运行一下<code>go clean -cache</code>命令就好了。<br>&nbsp;<br>对于测试成功的结果，go 命令也是会缓存的。运行<code>go clean -testcache</code>将会删除所有的测试结果缓存。不过，这样做肯定不会删除任何构建结果缓存。<br>&nbsp;</p>
<blockquote>
<p>此外，设置环境变量<code>GODEBUG</code>的值也可以稍稍地改变 go 命令的缓存行为。比如，设置值为<code>gocacheverify=1</code>将会导致 go 命令绕过任何的缓存数据，而真正地执行操作并重新生成所有结果，然后再去检查新的结果与现有的缓存数据是否一致。</p>
</blockquote>
<p>&nbsp;<br>总之，我们并不用在意缓存数据的存在，因为它们肯定不会妨碍<code>go test</code>命令打印正确的测试结果。</p>
<p>&nbsp;<br>你可能会问，如果测试失败，命令打印的结果将会是怎样的？如果功能测试函数的那个唯一参数被命名为<code>t</code>，那么当我们在其中调用<code>t.Fail</code>方法时，虽然当前的测试函数会继续执行下去，但是结果会显示该测试失败。如下所示：<br>&nbsp;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ go test puzzlers&#x2F;article20&#x2F;q2</span><br><span class="line">--- FAIL: TestFail (0.00s)</span><br><span class="line"> demo53_test.go:49: Failed.</span><br><span class="line">FAIL</span><br><span class="line">FAIL puzzlers&#x2F;article20&#x2F;q2 0.007s</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p>我们运行的命令与之前是相同的，但是我新增了一个功能测试函数<code>TestFail</code>，并在其中调用了<code>t.Fail</code>方法。测试结果显示，对被测代码包的测试，由于<code>TestFail</code>函数的测试失败而宣告失败。</p>
<p>&nbsp;<br>注意，对于失败测试的结果，<code>go test</code>命令并不会进行缓存，所以，这种情况下的每次测试都会产生全新的结果。另外，如果测试失败了，那么<code>go test</code>命令将会导致：失败的测试函数中的常规测试日志一并被打印出来。<br>&nbsp;<br>在这里的测试结果中，之所以显示了“demo53_test.go:49: Failed.”这一行，是因为我在<code>TestFail</code>函数中的调用表达式<code>t.Fail()</code>的下边编写了代码<code>t.Log(&quot;Failed.&quot;)</code>。<br>&nbsp;<br><code>t.Log</code>方法以及<code>t.Logf</code>方法的作用，就是打印常规的测试日志，只不过当测试成功的时候，<code>go test</code>命令就不会打印这类日志了。如果你想在测试结果中看到所有的常规测试日志，那么可以在运行<code>go test</code>命令的时候加入标记<code>-v</code>。<br>&nbsp;<br>若我们想让某个测试函数在执行的过程中立即失败，则可以在该函数中调用<code>t.FailNow</code>方法。<br>&nbsp;<br>我在下面把<code>TestFail</code>函数中的<code>t.Fail()</code>改为<code>t.FailNow()</code>。<br>&nbsp;<br>与<code>t.Fail()</code>不同，在<code>t.FailNow()</code>执行之后，当前函数会立即终止执行。换句话说，该行代码之后的所有代码都会失去执行机会。在这样修改之后，我再次运行上面的命令，得到的结果如下：<br>&nbsp;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--- FAIL: TestFail (0.00s)</span><br><span class="line">FAIL</span><br><span class="line">FAIL puzzlers&#x2F;article20&#x2F;q2 0.008s</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p>显然，之前显示在结果中的常规测试日志并没有出现在这里。</p>
<p>&nbsp;<br>顺便说一下，如果你想在测试失败的同时打印失败测试日志，那么可以直接调用<code>t.Error</code>方法或者<code>t.Errorf</code>方法。<br>&nbsp;<br>前者相当于<code>t.Log</code>方法和<code>t.Fail</code>方法的连续调用，而后者也与之类似，只不过它相当于先调用了<code>t.Logf</code>方法。<br>&nbsp;<br>除此之外，还有<code>t.Fatal</code>方法和<code>t.Fatalf</code>方法，它们的作用是在打印失败错误日志之后立即终止当前测试函数的执行并宣告测试失败。更具体地说，这相当于它们在最后都调用了<code>t.FailNow</code>方法。<br>&nbsp;<br>怎样解释性能测试的测试结果？<br>&nbsp;<br>性能测试与功能测试的结果格式有很多相似的地方。我们在这里仅关注前者的特殊之处。请看下面的打印结果。<br>&nbsp;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ go test -bench&#x3D;. -run&#x3D;^$ puzzlers&#x2F;article20&#x2F;q3</span><br><span class="line">goos: darwin</span><br><span class="line">goarch: amd64</span><br><span class="line">pkg: puzzlers&#x2F;article20&#x2F;q3</span><br><span class="line">BenchmarkGetPrimes-8      500000       2314 ns&#x2F;op</span><br><span class="line">PASS</span><br><span class="line">ok   puzzlers&#x2F;article20&#x2F;q3 1.192s</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p>我在运行<code>go test</code>命令的时候加了两个标记。第一个标记及其值为<code>-bench=.</code>，只有有了这个标记，命令才会进行性能测试。该标记的值<code>.</code>表明需要执行任意名称的性能测试函数，当然了，函数名称还是要符合 Go 程序测试的基本规则的。</p>
<p>&nbsp;<br>第二个标记及其值是<code>-run=^$</code>，这个标记用于表明需要执行哪些功能测试函数，这同样也是以函数名称为依据的。该标记的值<code>^$</code>意味着：只执行名称为空的功能测试函数，换句话说，不执行任何功能测试函数。<br>&nbsp;<br>你可能已经看出来了，这两个标记的值都是正则表达式。实际上，它们只能以正则表达式为值。此外，如果运行<code>go test</code>命令的时候不加<code>-run</code>标记，那么就会使它执行被测代码包中的所有功能测试函数。<br>&nbsp;<br>再来看测试结果，重点说一下倒数第三行的内容。<code>BenchmarkGetPrimes-8</code>被称为单个性能测试的名称，它表示命令执行了性能测试函数<code>BenchmarkGetPrimes</code>，并且当时所用的最大 P 数量为<code>8</code>。<br>&nbsp;<br>最大 P 数量相当于可以同时运行 goroutine 的逻辑 CPU 的最大个数。这里的逻辑 CPU，也可以被称为 CPU 核心，但它并不等同于计算机中真正的 CPU 核心，只是 Go 语言运行时系统内部的一个概念，代表着它同时运行 goroutine 的能力。<br>&nbsp;<br>顺便说一句，一台计算机的 CPU 核心的个数，意味着它能在同一时刻执行多少条程序指令，代表着它并行处理程序指令的能力。<br>&nbsp;<br>我们可以通过调用 <code>runtime.GOMAXPROCS</code>函数改变最大 P 数量，也可以在运行<code>go test</code>命令时，加入标记<code>-cpu</code>来设置一个最大 P 数量的列表，以供命令在多次测试时使用。<br>&nbsp;<br>在性能测试名称右边的是，<code>go test</code>命令最后一次执行性能测试函数（即<code>BenchmarkGetPrimes</code>函数）的时候，被测函数（即<code>GetPrimes</code>函数）被执行的实际次数。这是什么意思呢？<br>&nbsp;<br><code>go test</code>命令在执行性能测试函数的时候会给它一个正整数，若该测试函数的唯一参数的名称为<code>b</code>，则该正整数就由<code>b.N</code>代表。我们应该在测试函数中配合着编写代码，比如：<br>&nbsp;<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line"> GetPrimes(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p>我在一个会迭代<code>b.N</code>次的循环中调用了<code>GetPrimes</code>函数，并给予它参数值<code>1000</code>。<code>go test</code>命令会先尝试把<code>b.N</code>设置为<code>1</code>，然后执行测试函数。</p>
<p>&nbsp;<br>如果测试函数的执行时间没有超过上限（此上限默认为 1 秒），那么命令就会改大<code>b.N</code>的值，然后再次执行测试函数，如此往复，直到这个时间大于或等于上限为止。<br>&nbsp;<br>当某次执行的时间大于或等于上限时，我们就说这是命令此次对该测试函数的最后一次执行。这时的<code>b.N</code>的值就会被包含在测试结果中，也就是上述测试结果中的<code>500000</code>。<br>&nbsp;<br>我们可以简称该值为执行次数，但要注意，它指的是被测函数的执行次数，而不是性能测试函数的执行次数。<br>&nbsp;<br>最后再看这个执行次数的右边，<code>2314 ns/op</code>表明单次执行<code>GetPrimes</code>函数的平均耗时为<code>2314</code>纳秒。这其实就是通过将最后一次执行测试函数时的执行时间，除以（被测函数的）执行次数而得出的。<br>&nbsp;</p>
<p><img src="https://raw.githubusercontent.com/wht6/image/master/img/benchmark_202235.png" alt></p>
<p>&nbsp;</p>
<h3 id="cpu的功能"><a href="#cpu的功能" class="headerlink" title="-cpu的功能"></a><code>-cpu</code>的功能</h3><p>&nbsp;<br><code>go test</code>命令的标记<code>-cpu</code>，它是用来设置测试执行最大 P 数量的列表的。<br>&nbsp;</p>
<blockquote>
<p>P 是 processor 的缩写，每个 processor 都是一个可以承载若干个 G，且能够使这些 G 适时地与 M 进行对接并得到真正运行的中介。</p>
<p>正是由于 P 的存在，G 和 M 才可以呈现出多对多的关系，并能够及时、灵活地进行组合和分离。</p>
<p>这里的 G 就是 goroutine 的缩写，可以被理解为 Go 语言自己实现的用户级线程。M 即为 machine 的缩写，代表着系统级线程，或者说操作系统内核级别的线程。</p>
</blockquote>
<p>&nbsp;<br>Go 语言并发编程模型中的 P，正是 goroutine 的数量能够数十万计的关键所在。P 的数量意味着 Go 程序背后的运行时系统中，会有多少个用于承载可运行的 G 的队列存在。<br>&nbsp;<br>每一个队列都相当于一条流水线，它会源源不断地把可运行的 G 输送给空闲的 M，并使这两者对接。<br>&nbsp;<br>一旦对接完成，被对接的 G 就真正地运行在操作系统的内核级线程之上了。每条流水线之间虽然会有联系，但都是独立运作的。<br>&nbsp;<br>因此，最大 P 数量就代表着 Go 语言运行时系统同时运行 goroutine 的能力，也可以被视为其中逻辑 CPU 的最大个数。而<code>go test</code>命令的<code>-cpu</code>标记正是用于设置这个最大个数的。<br>&nbsp;<br>也许你已经知道，在默认情况下，最大 P 数量就等于当前计算机 CPU 核心的实际数量。<br>&nbsp;<br>当然了，前者也可以大于或者小于后者，如此可以在一定程度上模拟拥有不同的 CPU 核心数的计算机。<br>&nbsp;<br>所以，也可以说，使用<code>-cpu</code>标记可以模拟：被测程序在计算能力不同计算机中的表现。<br>&nbsp;<br><strong>怎样设置<code>-cpu</code>标记的值，以及它会对测试流程产生什么样的影响？</strong><br>&nbsp;<br>标记<code>-cpu</code>的值应该是一个正整数的列表，该列表的表现形式为：以英文半角逗号分隔的多个整数字面量，比如<code>1,2,4</code>。<br>&nbsp;<br>针对于此值中的每一个正整数，<code>go test</code>命令都会先设置最大 P 数量为该数，然后再执行测试函数。<br>&nbsp;<br>如果测试函数有多个，那么<code>go test</code>命令会依照此方式逐个执行。<br>&nbsp;</p>
<blockquote>
<p>以<code>1,2,4</code>为例，<code>go test</code>命令会先以<code>1</code>,<code>2</code>,<code>4</code>为最大 P 数量分别去执行第一个测试函数，之后再用同样的方式执行第二个测试函数，以此类推。</p>
</blockquote>
<p>&nbsp;<br>不论我们是否追加了<code>-cpu</code>标记，<code>go test</code>命令执行测试函数时流程都是相同的，只不过具体执行步骤会略有不同。<br>&nbsp;<br><code>go test</code>命令在进行准备工作的时候会读取<code>-cpu</code>标记的值，并把它转换为一个以<code>int</code>为元素类型的切片，我们也可以称它为逻辑 CPU 切片。<br>&nbsp;<br>如果该命令发现我们并没有追加这个标记，那么就会让逻辑 CPU 切片只包含一个元素值，即最大 P 数量的默认值，也就是当前计算机 CPU 核心的实际数量。<br>&nbsp;<br>在准备执行某个测试函数的时候，无论该函数是功能测试函数，还是性能测试函数，<code>go test</code>命令都会迭代逻辑 CPU 切片，并且在每次迭代时，先依据当前的元素值设置最大 P 数量，然后再去执行测试函数。<br>&nbsp;<br>注意，对于性能测试函数来说，这里可能不只执行了一次。<br>&nbsp;<br>概括来讲，<code>go test</code>命令每一次对性能测试函数的执行，都是一个探索的过程。它会在测试函数的执行时间上限不变的前提下，尝试找到被测程序的最大执行次数。<br>&nbsp;<br>在这个过程中，性能测试函数可能会被执行多次。为了以后描述方便，我们把这样一个探索的过程称为：对性能测试函数的一次探索式执行，这其中包含了对该函数的若干次执行，当然，肯定也包括了对被测程序更多次的执行。<br>&nbsp;<br>说到多次执行测试函数，我们就不得不提及另外一个标记，即<code>-count</code>。<code>-count</code>标记是专门用于重复执行测试函数的。它的值必须大于或等于<code>0</code>，并且默认值为<code>1</code>。<br>&nbsp;<br>如果我们在运行<code>go test</code>命令的时候追加了<code>-count 5</code>，那么对于每一个测试函数，命令都会在预设的不同条件下（比如不同的最大 P 数量下）分别重复执行五次。<br>&nbsp;<br>如果我们把前文所述的<code>-cpu</code>标记、<code>-count</code>标记，以及探索式执行联合起来看，就可以用一个公式来描述单个性能测试函数，在<code>go test</code>命令的一次运行过程中的执行次数，即：<br>&nbsp;</p>
<blockquote>
<p>性能测试函数的执行次数 = <code>-cpu</code>标记的值中正整数的个数 x <code>-count</code>标记的值 x 探索式执行中测试函数的实际执行次数</p>
</blockquote>
<p>&nbsp;<br>对于功能测试函数来说，这个公式会更加简单一些，即：<br>&nbsp;</p>
<blockquote>
<p>功能测试函数的执行次数 = <code>-cpu</code>标记的值中正整数的个数 x <code>-count</code>标记的值</p>
</blockquote>
<p>&nbsp;<br><img src="https://raw.githubusercontent.com/wht6/image/master/img/count_202235.png" alt><br>&nbsp;<br>你也许遇到过这种情况，在对 Go 程序执行某种自动化测试的过程中，测试日志会显得特别多，而且好多都是重复的。<br>&nbsp;<br>这时，我们首先就应该想到，上面这些导致测试函数多次执行的标记和流程。我们往往需要检查这些标记的使用是否合理、日志记录是否有必要等等，从而对测试日志进行精简。<br>&nbsp;<br>比如，对于功能测试函数来说，我们通常没有必要重复执行它，即使是在不同的最大 P 数量下也是如此。注意，这里所说的重复执行指的是，在被测程序的输入（比如说被测函数的参数值）相同情况下的多次执行。<br>&nbsp;<br>有些时候，在输入完全相同的情况下，被测程序会因其他外部环境的不同，而表现出不同的行为。这时我们需要考虑的往往应该是：这个程序在设计上是否合理，而不是通过重复执行测试来检测风险。<br>&nbsp;<br>还有些时候，我们的程序会无法避免地依赖一些外部环境，比如数据库或者其他服务。这时，我们依然不应该让测试的反复执行成为检测手段，而应该在测试中通过仿造（mock）外部环境，来规避掉它们的不确定性。<br>&nbsp;<br>其实，单元测试的意思就是：对单一的功能模块进行边界清晰的测试，并且不掺杂任何对外部环境的检测。这也是“单元”二字要表达的主要含义。<br>&nbsp;<br>正好相反，对于性能测试函数来说，我们常常需要反复地执行，并以此试图抹平当时的计算资源调度的细微差别对被测程序性能的影响。通过<code>-cpu</code>标记，我们还能够模拟被测程序在计算能力不同计算机中的性能表现。<br>&nbsp;<br>不过要注意，这里设置的最大 P 数量，最好不要超过当前计算机 CPU 核心的实际数量。因为一旦超出计算机实际的并行处理能力，Go 程序在性能上就无法再得到显著地提升了。<br>&nbsp;<br>这就像一个漏斗，不论我们怎样灌水，水的漏出速度总是有限的。更何况，为了管理过多的 P，Go 语言运行时系统还会耗费额外的计算资源。<br>&nbsp;<br>显然，上述模拟得出的程序性能一定是不准确的。不过，这或多或少可以作为一个参考，因为，这样模拟出的性能一般都会低于程序在计算环境中的实际性能。<br>&nbsp;<br><strong><code>-parallel</code>标记的作用是什么？</strong><br>&nbsp;<br>在运行<code>go test</code>命令的时候，可以追加标记<code>-parallel</code>，该标记的作用是：设置同一个被测代码包中的功能测试函数的最大并发执行数。该标记的默认值是测试运行时的最大 P 数量（这可以通过调用表达式<code>runtime.GOMAXPROCS(0)</code>获得）。<br>&nbsp;<br>对于功能测试，为了加快测试速度，命令通常会并发地测试多个被测代码包。<br>&nbsp;<br>但是，在默认情况下，对于同一个被测代码包中的多个功能测试函数，命令会串行地执行它们。除非我们在一些功能测试函数中显式地调用<code>t.Parallel</code>方法。<br>&nbsp;<br>这个时候，这些包含了<code>t.Parallel</code>方法调用的功能测试函数就会被<code>go test</code>命令并发地执行，而并发执行的最大数量正是由<code>-parallel</code>标记值决定的。不过要注意，同一个功能测试函数的多次执行之间一定是串行的。<br>&nbsp;<br>强调一下，<code>-parallel</code>标记对性能测试是无效的。当然了，对于性能测试来说，也是可以并发进行的，不过机制上会有所不同。<br>&nbsp;<br><strong>性能测试函数中的计时器是做什么用的?</strong><br>&nbsp;<br><code>testing</code>包的<code>testing.B</code>类型有这么几个指针方法：<code>StartTimer</code>、<code>StopTimer</code>和<code>ResetTimer</code>。这些方法都是用于操作当前的性能测试函数专属的计时器的。<br>&nbsp;<br>所谓的计时器，是一个逻辑上的概念，它其实是<code>testing.B</code>类型中一些字段的统称。这些字段用于记录：当前测试函数在当次执行过程中耗费的时间、分配的堆内存的字节数以及分配次数。<br>&nbsp;<br>下面会以测试函数的执行时间为例，来说明此计时器的用法。不过，你需要知道的是，这三个方法在开始记录、停止记录或重新记录执行时间的同时，也会对堆内存分配字节数和分配次数的记录起到相同的作用。<br>&nbsp;<br>实际上，<code>go test</code>命令本身就会用到这样的计时器。当准备执行某个性能测试函数的时候，命令会重置并启动该函数专属的计时器。一旦这个函数执行完毕，命令又会立即停止这个计时器。<br>&nbsp;<br>如此一来，命令就能够准确地记录下（我们在前面多次提到的）测试函数执行时间了。然后，命令就会将这个时间与执行时间上限进行比较，并决定是否在改大<code>b.N</code>的值之后，再次执行测试函数。<br>&nbsp;<br>这就是对性能测试函数的探索式执行。显然，如果我们在测试函数中自行操作这个计时器，就一定会影响到这个探索式执行的结果。也就是说，这会让命令找到被测程序的最大执行次数有所不同。<br>&nbsp;<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkGetPrimes</span><span class="params">(b *testing.B)</span></span> &#123;</span><br><span class="line"> b.StopTimer()</span><br><span class="line"> time.Sleep(time.Millisecond * <span class="number">500</span>) <span class="comment">// 模拟某个耗时但与被测程序关系不大的操作。</span></span><br><span class="line"> max := <span class="number">10000</span></span><br><span class="line"> b.StartTimer()</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line">  GetPrimes(max)</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p>需要注意的是该函数体中的前四行代码。我先停止了当前测试函数的计时器，然后通过调用<code>time.Sleep</code>函数，模拟了一个比较耗时的额外操作，并且在给变量<code>max</code>赋值之后又启动了该计时器。</p>
<p>&nbsp;<br>你可以想象一下，我们需要耗费额外的时间去确定<code>max</code>变量的值，虽然在后面它会被传入<code>GetPrimes</code>函数，但是，针对<code>GetPrimes</code>函数本身的性能测试并不应该包含确定参数值的过程。<br>&nbsp;<br>因此，我们需要把这个过程所耗费的时间，从当前测试函数的执行时间中去除掉。这样就能够避免这一过程对测试结果的不良影响了。<br>&nbsp;<br>每当这个测试函数执行完毕后，<code>go test</code>命令拿到的执行时间都只应该包含调用<code>GetPrimes</code>函数所耗费的那些时间。只有依据这个时间做出的后续判断，以及找到被测程序的最大执行次数才是准确的。<br>&nbsp;<br>在性能测试函数中，我们可以通过对<code>b.StartTimer</code>和<code>b.StopTimer</code>方法的联合运用，再去除掉任何一段代码的执行时间。<br>&nbsp;<br>相比之下，<code>b.ResetTimer</code>方法的灵活性就要差一些了，它只能用于：去除在调用它之前那些代码的执行时间。不过，无论在调用它的时候，计时器是不是正在运行，它都可以起作用。<br>&nbsp;<br>扩展：<code>-benchmem</code>标记的作用是在性能测试完成后打印内存分配统计信息。<code>-benchtime</code>标记的作用是设定测试函数的执行时间上限。</p>
<p>&nbsp;<br>&nbsp;</p>
<p>原文链接：<a href="https://time.geekbang.org/column/intro/112">https://time.geekbang.org/column/intro/112</a></p>
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5 itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "http://wht6.github.io/posts/cd2d.html",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "http://wht6.github.io/posts/cd2d.html";
            const title         = "「测试的基本规则和流程」";
            const excerpt       = `对于程序或软件的测试也分很多种，比如：单元测试、API 测试、集成测试、灰度测试，等等。在篇会主要针对单元测试进行讲解。
&nbsp;
单元测试的类别&nbsp;单元测试，它又称程序员测试。顾名思义，这就是程序员们本该做的自我检查工作...`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/Go%E8%AF%AD%E8%A8%80/" rel="tag">Go语言</a>
                </div>
                <div class="pull-date">
                    <time datetime="2022-04-02T08:39:12.975Z" itemprop="dateModified">最后编辑：2022-04-02</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" LaTex常用命令" href="/posts/b9ca.html">&lt; 上一篇</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" 标准库中的sync包" href="/posts/3ed6.html">下一篇 &gt;</a>
            </div>
            
        </nav>
    
    
</article>

        

            </section>

        

                
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/avatar.webp" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center">学习技术，而不止于技术</p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                83
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                7
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                47
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类目录</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/">云原生</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C/">网络</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a><span class="category-list-count">21</span></li></ul>
  </aside>


            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/Ansible/" style="font-size: 0.64em;">Ansible</a> <a href="/tags/DNS/" style="font-size: 0.6em;">DNS</a> <a href="/tags/DevOps/" style="font-size: 0.6em;">DevOps</a> <a href="/tags/Docker/" style="font-size: 0.72em;">Docker</a> <a href="/tags/GitLab/" style="font-size: 0.6em;">GitLab</a> <a href="/tags/Go/" style="font-size: 0.6em;">Go</a> <a href="/tags/Golang/" style="font-size: 0.6em;">Golang</a> <a href="/tags/Go%E8%AF%AD%E8%A8%80/" style="font-size: 0.8em;">Go语言</a> <a href="/tags/InnoDB/" style="font-size: 0.6em;">InnoDB</a> <a href="/tags/Kubernetes/" style="font-size: 0.68em;">Kubernetes</a> <a href="/tags/Linux/" style="font-size: 0.6em;">Linux</a> <a href="/tags/MySQL/" style="font-size: 0.76em;">MySQL</a> <a href="/tags/Nginx/" style="font-size: 0.6em;">Nginx</a> <a href="/tags/Python/" style="font-size: 0.72em;">Python</a> <a href="/tags/Python%E8%AF%AD%E8%A8%80/" style="font-size: 0.68em;">Python语言</a> <a href="/tags/SNMP/" style="font-size: 0.6em;">SNMP</a> <a href="/tags/Shell/" style="font-size: 0.68em;">Shell</a> <a href="/tags/Zabbix/" style="font-size: 0.64em;">Zabbix</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/posts/baa4.html"><i class="fa  fa-book"></i> Kubernetes环境部署</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/c1d.html"><i class="fa  fa-book"></i> 数据处理之Awk工具</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/79b6.html"><i class="fa  fa-book"></i> 数据处理之Sed工具</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/9d01.html"><i class="fa  fa-book"></i> e2ec代码浅析</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/638a.html"><i class="fa  fa-book"></i> 源码学习net/http</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        <!-- Keep for compatibility -->
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <!-- New links -->
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2023 WHT 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by 王贺天.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>


    <script async src="/js/candy.min.js"></script>




    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>



<!-- Extra support for third-party plguins  -->


    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/ Relative)","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":100,"height":180},"mobile":{"show":false},"react":{"opacityDefault":0.7}});</script></body>
</html>