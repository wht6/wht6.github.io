<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Docker的基本概念和命令 | WHT</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="技术，运维,编程，兴趣" />
  
  <meta name="description" content="01|基本概念1、Docker架构&amp;nbsp;&amp;nbsp;  Client： 客户端；操作docker服务器的客户端（命令行或者界面） Docker_Host：Docker主机；安装Docker服务的主机 Docker_Daemon：后台进程；运行在Docker服务器的后台进程 Containers：容器；在Docker服务器中的容器（一个容器一般是一个应用实例，容器间互相隔离） Images：镜">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker的基本概念和命令">
<meta property="og:url" content="http://wht6.github.io/posts/865e.html">
<meta property="og:site_name" content="WHT">
<meta property="og:description" content="01|基本概念1、Docker架构&amp;nbsp;&amp;nbsp;  Client： 客户端；操作docker服务器的客户端（命令行或者界面） Docker_Host：Docker主机；安装Docker服务的主机 Docker_Daemon：后台进程；运行在Docker服务器的后台进程 Containers：容器；在Docker服务器中的容器（一个容器一般是一个应用实例，容器间互相隔离） Images：镜">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/wht6/image/master/img/dockerarch_2022315.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wht6/image/master/img/dockervm_2022315.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wht6/image/master/img/dockercommand_2022315.png">
<meta property="article:published_time" content="2022-03-15T03:00:00.000Z">
<meta property="article:modified_time" content="2022-03-16T07:02:45.965Z">
<meta property="article:author" content="并指如刀">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="容器">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wht6/image/master/img/dockerarch_2022315.png">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  
<link rel="stylesheet" href="/css/style.css">

  
<script src="/js/pace.min.js"></script>

  

  
  

<style type="text/css" lang="css">
    #loading-container{
        position: fixed;
        top: 0;
        left: 0;
        min-height: 100vh;
        width: 100vw;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: #FFF;
        text-align: center;
        /* loader页面消失采用渐隐的方式*/
        -webkit-transition: opacity 1s ease;
        -moz-transition: opacity 1s ease;
        -o-transition: opacity 1s ease;
        transition: opacity 1s ease;
    }
    .loading-image{
        width: 120px;
        height: 50px;
        transform: translate(-50%);
    }
    
    .loading-image div:nth-child(2) {
        -webkit-animation: pacman-balls 1s linear 0s infinite;
        animation: pacman-balls 1s linear 0s infinite
    }

    .loading-image div:nth-child(3) {
        -webkit-animation: pacman-balls 1s linear .33s infinite;
        animation: pacman-balls 1s linear .33s infinite
    }

    .loading-image div:nth-child(4) {
        -webkit-animation: pacman-balls 1s linear .66s infinite;
        animation: pacman-balls 1s linear .66s infinite
    }

    .loading-image div:nth-child(5) {
        -webkit-animation: pacman-balls 1s linear .99s infinite;
        animation: pacman-balls 1s linear .99s infinite
    }
    
   .loading-image div:first-of-type {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_up .5s 0s infinite;
        animation: rotate_pacman_half_up .5s 0s infinite;
    }
    .loading-image div:nth-child(2) {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_down .5s 0s infinite;
        animation: rotate_pacman_half_down .5s 0s infinite;
        margin-top: -50px;
    }
    @-webkit-keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @-webkit-keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}

    @keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}
    
    @-webkit-keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}

    @keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}
    
   
    .loading-image div:nth-child(3),
    .loading-image div:nth-child(4),
    .loading-image div:nth-child(5),
    .loading-image div:nth-child(6){
        background-color: #49b1f5;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        margin: 2px;
        width: 10px;
        height: 10px;
        position: absolute;
        transform: translateY(-6.25px);
        top: 25px;
        left: 100px;
    }
    .loading-text{
        margin-bottom: 20vh;
        text-align: center;
        color: #2c3e50;
        font-size: 2rem;
        box-sizing: border-box;
        padding: 0 10px;
        text-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    @media only screen and (max-width: 500px) {
         .loading-text{
            font-size: 1.5rem;
         }
    }
    .fadeout {
        opacity: 0;
        filter: alpha(opacity=0);
    }
    /* logo出现动画 */
    @-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}
    @keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);}}
 </style>
 <script>
(function () {
    const loaded = function(){
       setTimeout(function(){
            const loader = document.getElementById("loading-container");
            loader.className="fadeout" ;//使用渐隐的方法淡出loading page
            // document.getElementById("body-wrap").style.display="flex";
            setTimeout(function(){
                loader.style.display="none";
            },1000); 
        },1000);//强制显示loading page 1s  
    };
    loaded();
})()
 </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="WHT" type="application/atom+xml">
</head>


 <div id="loading-container">
     <p class="loading-text">玩命加载中 . . . </p> 
     <div class="loading-image">
         <div></div>
         <div></div>
         <div></div>
         <div></div> 
         <div></div>
     </div>
 </div><body>
  <div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">WHT&#39;s Blog</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a  href="/">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </a>
                    
                    <a  href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>Archives</span>
                    </a>
                    
                    <a  href="/about">
                        <i class="fa fa-user"></i>
                        <span>About</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        WHT&#39;s Blog
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        一个专注知识分享的技术博客
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="WHT&#39;s Blog" target="_blank" href="//wht6.github.io">
                            <i class="fa fa-home fa-2x"></i></a>
                    
                        <a title="Github" target="_blank" href="//github.com/wht6">
                            <i class="fa fa-github fa-2x"></i></a>
                    
                        <a title="Weibo" target="_blank" href="//weibo.com/wht6">
                            <i class="fa fa-weibo fa-2x"></i></a>
                    
                        <a title="Twitter" target="_blank" href="//twitter.com/wht6">
                            <i class="fa fa-twitter fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-Docker的基本概念和命令" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      Docker的基本概念和命令
    </h1>
    <div class="post-title-bar">
      <ul>
          
              <li>
                  <i class="fa fa-book"></i>
                  
                      <a href="/categories/云计算/">云计算</a>
                  
              </li>
          
        <li>
          <i class="fa fa-calendar"></i>  2022-03-15
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <h2 id="01-基本概念"><a href="#01-基本概念" class="headerlink" title="01|基本概念"></a>01|基本概念</h2><h3 id="1、Docker架构"><a href="#1、Docker架构" class="headerlink" title="1、Docker架构"></a>1、Docker架构</h3><p>&nbsp;<br><img src="https://raw.githubusercontent.com/wht6/image/master/img/dockerarch_2022315.png" alt><br>&nbsp;</p>
<ul>
<li>Client： 客户端；操作docker服务器的客户端（命令行或者界面）</li>
<li>Docker_Host：Docker主机；安装Docker服务的主机</li>
<li>Docker_Daemon：后台进程；运行在Docker服务器的后台进程</li>
<li>Containers：容器；在Docker服务器中的容器（一个容器一般是一个应用实例，容器间互相隔离）</li>
<li>Images：镜像、映像、程序包；Image是只读模板，其中包含创建Docker容器的说明。容器是由Image运<br>行而来，Image固定不变。</li>
<li>Registries：仓库；存储Docker Image的地方。官方远程仓库地址： <a target="_blank" rel="noopener" href="https://hub.docker.com/search">https://hub.docker.com/search</a></li>
</ul>
<p>&nbsp;</p>
<blockquote>
<p>Docker用Go编程语言编写，并利用Linux内核的多种功能来交付其功能。 Docker使用一种称为命名空间的技术来提供容器的隔离工作区。 运行容器时，Docker会为该容器创建一组命名空间。 这些命名空间提供了一层隔离。 容器的每个方面都在单独的命名空间中运行，并且对其的访问仅限于该命名空间。  </p>
</blockquote>
<p>&nbsp;</p>
<p><strong>镜像和容器的关系</strong>（一个类可以创建多个实例）（镜像和容器也可以比作软件安装包和软件，一个安装包可以在多个机器上安装多个软件）<br>&nbsp;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Docker</th>
<th>面向对象</th>
</tr>
</thead>
<tbody>
<tr>
<td>镜像（Image）</td>
<td>类</td>
</tr>
<tr>
<td>容器（Container）</td>
<td>对象（实例）</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;<br><strong>容器与虚拟机</strong><br>&nbsp;</p>
<p><img src="https://raw.githubusercontent.com/wht6/image/master/img/dockervm_2022315.png" alt><br>&nbsp;</p>
<h3 id="2、Docker隔离原理"><a href="#2、Docker隔离原理" class="headerlink" title="2、Docker隔离原理"></a>2、Docker隔离原理</h3><p>&nbsp;<br><strong>namespace 6项隔离</strong> （资源隔离）<br>&nbsp;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>namespace</th>
<th>系统调用参数</th>
<th>隔离内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>UTS</td>
<td>CLONE_NEWUTS</td>
<td>主机和域名</td>
</tr>
<tr>
<td>IPC</td>
<td>CLONE_NEWIPC</td>
<td>信号量、消息队列和共享内存</td>
</tr>
<tr>
<td>PID</td>
<td>CLONE_NEWPID</td>
<td>进程编号</td>
</tr>
<tr>
<td>Network</td>
<td>CLONE_NEWNET</td>
<td>网络设备、网络栈、端口等</td>
</tr>
<tr>
<td>Mount</td>
<td>CLONE_NEWNS</td>
<td>挂载点(文件系统)</td>
</tr>
<tr>
<td>User</td>
<td>CLONE_NEWUSER</td>
<td>用户和用户组</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;<br><strong>cgroups资源限制</strong> （资源限制）<br>&nbsp;<br>cgroup提供的主要功能如下：<br>&nbsp;</p>
<ul>
<li>资源限制：限制任务使用的资源总额，并在超过这个 配额 时发出提示</li>
<li>优先级分配：分配CPU时间片数量及磁盘IO带宽大小、控制任务运行的优先级</li>
<li>资源统计：统计系统资源使用量，如CPU使用时长、内存用量等</li>
<li>任务控制：对任务执行挂起、恢复等操作</li>
</ul>
<p>&nbsp;<br>cgroup资源控制系统，每种子系统独立地控制一种资源。功能如下：<br>&nbsp;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>子系统</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>cpu</td>
<td>使用调度程序控制任务对CPU的使用。</td>
</tr>
<tr>
<td>cpuacct(CPU Accounting)</td>
<td>自动生成cgroup中任务对CPU资源使用情况的报告。</td>
</tr>
<tr>
<td>cpuset</td>
<td>为cgroup中的任务分配独立的CPU(多处理器系统时)和内存。</td>
</tr>
<tr>
<td>devices</td>
<td>开启或关闭cgroup中任务对设备的访问</td>
</tr>
<tr>
<td>freezer</td>
<td>挂起或恢复cgroup中的任务</td>
</tr>
<tr>
<td>memory</td>
<td>设定cgroup中任务对内存使用量的限定，并生成这些任务对内存资源使用 情况的报告</td>
</tr>
<tr>
<td>perf_event(Linux CPU性能探测器)</td>
<td>使cgroup中的任务可以进行统一的性能测试</td>
</tr>
<tr>
<td>net_cls(Docker未使 用)</td>
<td>通过等级识别符标记网络数据包，从而允许Linux流量监控程序(Trawic Controller)识别从具体cgroup中生成的数据包</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<h3 id="3、Docker安装"><a href="#3、Docker安装" class="headerlink" title="3、Docker安装"></a>3、Docker安装</h3><p>&nbsp;</p>
<blockquote>
<p>以下以centos为例；<br>更多其他安装方式，详细参照文档： <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a>  </p>
</blockquote>
<p>&nbsp;</p>
<h4 id="1、移除旧版本"><a href="#1、移除旧版本" class="headerlink" title="　1、移除旧版本"></a>　1、移除旧版本</h4><p>&nbsp;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker*</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h4 id="2、设置docker-yum源"><a href="#2、设置docker-yum源" class="headerlink" title="2、设置docker yum源"></a>2、设置docker yum源</h4><p>&nbsp;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">--add-repo \</span><br><span class="line">https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h4 id="3、安装最新docker-engine"><a href="#3、安装最新docker-engine" class="headerlink" title="3、安装最新docker engine"></a>3、安装最新docker engine</h4><p>&nbsp;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h4 id="4、安装指定版本docker-engine"><a href="#4、安装指定版本docker-engine" class="headerlink" title="4、安装指定版本docker engine"></a>4、安装指定版本docker engine</h4><p>&nbsp;</p>
<h5 id="1、在线安装"><a href="#1、在线安装" class="headerlink" title="1、在线安装"></a>1、在线安装</h5><p>&nbsp;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#找到所有可用docker版本列表</span></span><br><span class="line">yum list docker-ce --showduplicates | sort -r</span><br><span class="line"><span class="comment"># 安装指定版本，用上面的版本号替换&lt;VERSION_STRING&gt;</span></span><br><span class="line">sudo yum install docker-ce-&lt;VERSION_STRING&gt;.x86_64 docker-ce-cli-</span><br><span class="line">&lt;VERSION_STRING&gt;.x86_64 containerd.io</span><br><span class="line"><span class="comment">#例如：</span></span><br><span class="line"><span class="comment">#yum install docker-ce-3:20.10.5-3.el7.x86_64 docker-ce-cli-3:20.10.5-</span></span><br><span class="line">3.el7.x86_64 containerd.io</span><br><span class="line"><span class="comment">#注意加上 .x86_64 大版本号</span></span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h5 id="2、离线安装"><a href="#2、离线安装" class="headerlink" title="2、离线安装"></a>2、离线安装</h5><p>&nbsp;<br><a target="_blank" rel="noopener" href="https://download.docker.com/linux/centos/7/x86_64/stable/Packages/">https://download.docker.com/linux/centos/7/x86_64/stable/Packages/</a><br>&nbsp;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh xxx.rpm</span><br><span class="line"><span class="comment"># 可以下载 tar</span></span><br><span class="line"><span class="comment"># 解压启动即可</span></span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/binaries/#install-daemon-and-client-binaries-on-linux">https://docs.docker.com/engine/install/binaries/#install-daemon-and-client-binaries-on-linux</a>  </p>
<p>&nbsp;</p>
<h4 id="5、启动服务"><a href="#5、启动服务" class="headerlink" title="5、启动服务"></a>5、启动服务</h4><p>&nbsp;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line">docker version <span class="comment"># 查看Docker的版本</span></span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h4 id="6、镜像加速"><a href="#6、镜像加速" class="headerlink" title="6、镜像加速"></a>6、镜像加速</h4><p>&nbsp;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://82m9ar63.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">&#125; E</span><br><span class="line">OF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br><span class="line"><span class="comment">#以后docker下载直接从阿里云拉取相关镜像</span></span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<blockquote>
<p>/etc/docker/daemon.json 是Docker的核心配置文件。  </p>
</blockquote>
<p>&nbsp;</p>
<h4 id="7、可视化界面-Portainer"><a href="#7、可视化界面-Portainer" class="headerlink" title="7、可视化界面-Portainer"></a>7、可视化界面-Portainer</h4><p>&nbsp;</p>
<h5 id="1、什么是Portainer"><a href="#1、什么是Portainer" class="headerlink" title="1、什么是Portainer"></a>1、什么是Portainer</h5><p>&nbsp;<br><a target="_blank" rel="noopener" href="https://documentation.portainer.io/">https://documentation.portainer.io/</a><br>&nbsp;<br>Portainer社区版2.0拥有超过50万的普通用户，是功能强大的开源工具集，可让您轻松地在Docker，Swarm，Kubernetes和Azure ACI中构建和管理容器。 Portainer的工作原理是在易于使用的GUI后面隐藏使管理容器变得困难的复杂性。通过消除用户使用CLI，编写YAML或理解清单的需求，Portainer使部署应用程序和解决问题变得如此简单，任何人都可以做到。 Portainer开发团队在这里为您的Docker之旅提供帮助；<br>&nbsp;</p>
<h5 id="2、安装"><a href="#2、安装" class="headerlink" title="2、安装"></a>2、安装</h5><p>&nbsp;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 服务端部署</span></span><br><span class="line">docker run -d -p 8000:8000 -p 9000:9000 --name=portainer --restart=always -v</span><br><span class="line">/var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data</span><br><span class="line">portainer/portainer-ce</span><br><span class="line"><span class="comment"># 访问 9000 端口即可</span></span><br><span class="line"><span class="comment">#agent端部署</span></span><br><span class="line">docker run -d -p 9001:9001 --name portainer_agent --restart=always -v</span><br><span class="line">/var/run/docker.sock:/var/run/docker.sock -v</span><br><span class="line">/var/lib/docker/volumes:/var/lib/docker/volumes portainer/agent</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h2 id="02-Docker命令"><a href="#02-Docker命令" class="headerlink" title="02|Docker命令"></a>02|Docker命令</h2><h3 id="1、常见命令"><a href="#1、常见命令" class="headerlink" title="1、常见命令"></a>1、常见命令</h3><p>&nbsp;<br>所有Docker命令手册<br><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/docker/">https://docs.docker.com/engine/reference/commandline/docker/</a><br>&nbsp;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>attach</code></td>
<td>绑定到运行中容器的 标准输入, 输出,以及错误流（这样似乎也能进入容器内容，但是 一定小心，他们操作的就是控制台，控制台的退出命令会生效，比如redis,nginx…）</td>
</tr>
<tr>
<td>build</td>
<td>从一个 Dockerfile 文件构建镜像</td>
</tr>
<tr>
<td><code>commit</code></td>
<td>把容器的改变 提交创建一个新的镜像</td>
</tr>
<tr>
<td><code>cp</code></td>
<td>容器和本地文件系统间 复制 文件/文件夹</td>
</tr>
<tr>
<td><code>create</code></td>
<td>创建新容器，但并不启动（注意与docker run 的区分）需要手动启动。start\stop</td>
</tr>
<tr>
<td><code>diff</code></td>
<td>检查容器里文件系统结构的更改【A：添加文件或目录 D：文件或者目录删除 C：文件或者目录更改】</td>
</tr>
<tr>
<td>events</td>
<td>获取服务器的实时事件</td>
</tr>
<tr>
<td>exec</td>
<td>在运行时的容器内运行命令</td>
</tr>
<tr>
<td><code>export</code></td>
<td>导出容器的文件系统为一个tar文件。commit是直接提交成镜像，export是导出成文件方便在本地移动。</td>
</tr>
<tr>
<td>history</td>
<td>显示镜像的历史</td>
</tr>
<tr>
<td><code>images</code></td>
<td>列出所有镜像</td>
</tr>
<tr>
<td><code>import</code></td>
<td>导入tar的内容创建一个镜像，但是导入进来的镜像无法直接启动容器。必须使用导出之前镜像的完整启动命令去启动它。用<code>docker ps --no-trunc</code>查看完整启动命令。</td>
</tr>
<tr>
<td>info</td>
<td>显示系统信息</td>
</tr>
<tr>
<td><code>inspect</code></td>
<td>获取docker对象的底层信息</td>
</tr>
<tr>
<td>kill</td>
<td>杀死一个或者多个容器</td>
</tr>
<tr>
<td><code>load</code></td>
<td>从 tar 文件加载镜像</td>
</tr>
<tr>
<td><code>login</code></td>
<td>登录Docker registry</td>
</tr>
<tr>
<td><code>logout</code></td>
<td>退出Docker registry</td>
</tr>
<tr>
<td><code>logs</code></td>
<td>获取容器日志</td>
</tr>
<tr>
<td><code>pause</code></td>
<td>暂停一个或者多个容器</td>
</tr>
<tr>
<td>port</td>
<td>列出容器的端口映射</td>
</tr>
<tr>
<td><code>ps</code></td>
<td>列出所有容器</td>
</tr>
<tr>
<td><code>pull</code></td>
<td>从registry下载一个image 或者repository</td>
</tr>
<tr>
<td><code>push</code></td>
<td>给registry推送一个image或者repository</td>
</tr>
<tr>
<td>rename</td>
<td>重命名一个容器</td>
</tr>
<tr>
<td>restart</td>
<td>重启一个或者多个容器</td>
</tr>
<tr>
<td><code>rm</code></td>
<td>移除一个或者多个容器</td>
</tr>
<tr>
<td><code>rmi</code></td>
<td>移除一个或者多个镜像</td>
</tr>
<tr>
<td><code>run</code></td>
<td>创建并启动容器</td>
</tr>
<tr>
<td><code>save</code></td>
<td>把一个或者多个镜像保存为tar文件</td>
</tr>
<tr>
<td>search</td>
<td>去docker hub寻找镜像</td>
</tr>
<tr>
<td><code>start</code></td>
<td>启动一个或者多个容器</td>
</tr>
<tr>
<td>stats</td>
<td>显示容器资源的实时使用状态</td>
</tr>
<tr>
<td><code>stop</code></td>
<td>停止一个或者多个容器</td>
</tr>
<tr>
<td><code>tag</code></td>
<td>给源镜像创建一个新的标签，变成新的镜像</td>
</tr>
<tr>
<td>top</td>
<td>显示正在运行容器的进程</td>
</tr>
<tr>
<td><code>unpause</code></td>
<td>pause的反操作</td>
</tr>
<tr>
<td>update</td>
<td>更新一个或者多个docker容器配置</td>
</tr>
<tr>
<td><code>version</code></td>
<td>Show the Docker version information</td>
</tr>
<tr>
<td>container</td>
<td>管理容器</td>
</tr>
<tr>
<td><code>image</code></td>
<td>管理镜像</td>
</tr>
<tr>
<td>network</td>
<td>管理网络</td>
</tr>
<tr>
<td>volume</td>
<td>管理卷</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;<br><strong>Docker命令的关系图</strong><br>&nbsp;<br><img src="https://raw.githubusercontent.com/wht6/image/master/img/dockercommand_2022315.png" alt><br>&nbsp;<br>根据正在运行的容器制作出相关的镜像：反向<br>&nbsp;<br>根据镜像启动一个容器：正向<br>&nbsp;<br><strong>下载镜像并启动一个容器</strong>：<br>&nbsp;<br>1、先去软件市场搜镜像：<a target="_blank" rel="noopener" href="https://registry.hub.docker.com/">docker hub</a></p>
<p>2、下载镜像 <code>docker pull xxx</code></p>
<p>3、启动软件 docker run 镜像名；<br>&nbsp;<br>通过命令<code>docker image --help</code>  查看镜像的所有管理操作。<br>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">docker pull redis == docker pull redis:latest（最新版）</span><br><span class="line"><span class="comment"># 阿里云的镜像是从docker hub来的，我们配置了加速，默认是从阿里云（缓存）下载</span></span><br><span class="line">docker images <span class="comment"># 查看本地所有镜像</span></span><br><span class="line"></span><br><span class="line">docker rmi 镜像名 <span class="comment"># 删除某个镜像 （-f为强制删除）</span></span><br><span class="line">docker rm 容器id <span class="comment"># 删除某个容器</span></span><br><span class="line">docker ps <span class="comment"># 列出所有容器 （-a则会将已经停止的容器也列出）</span></span><br><span class="line"></span><br><span class="line">docker rmi -f $(docker images -aq) <span class="comment">#删除全部镜像</span></span><br><span class="line">docker rm -f $(docker ps -aq) <span class="comment"># 删除所有容器</span></span><br><span class="line"></span><br><span class="line">docker image prune <span class="comment">#移除游离镜像 dangling：游离镜像（没有镜像名字的）</span></span><br><span class="line">docker tag 原镜像:标签 新镜像名:标签 <span class="comment">#起别名</span></span><br><span class="line"></span><br><span class="line">docker <span class="built_in">kill</span> 容器名 <span class="comment"># 是强制kill -9（直接拔电源）；</span></span><br><span class="line">docker stop 容器名 <span class="comment"># 可以允许优雅停机(当前正在运行中的程序处理完所有事情后再停止)</span></span><br><span class="line"></span><br><span class="line">docker logs mynginx <span class="comment"># -d运行前台没有输出，通过logs命令查看日志(可以加-f来持续追踪日志)</span></span><br><span class="line"></span><br><span class="line">docker attach <span class="comment"># 绑定的是控制台. 可能导致容器停止，所有一般不用这个命令，而用exec</span></span><br><span class="line"></span><br><span class="line">docker container inspect 容器名 = docker inspect 容器名 <span class="comment"># 查看容器的详细信息</span></span><br><span class="line">docker inspect image /network/volume ....</span><br><span class="line"></span><br><span class="line">docker cp index.html mynginx:/usr/share/nginx/html <span class="comment"># 复制文件</span></span><br><span class="line">docker cp mynginx:/etc/nginx/nginx.conf nginx.conf</span><br><span class="line"></span><br><span class="line">docker diff 容器名 <span class="comment"># 检查容器里文件系统结构的更改,即容器的改变</span></span><br><span class="line"></span><br><span class="line">docker commit -a 作者名 -m <span class="string">&quot;信息&quot;</span> mynginx4 mynginx:v4 <span class="comment">#  mynginx:v4是给镜像起的名字</span></span><br><span class="line"></span><br><span class="line">docker save -o busybox.tar busybox:latest <span class="comment"># 把busybox镜像保存成tar文件</span></span><br><span class="line">docker load -i busybox.tar <span class="comment"># 把压缩包里面的内容直接导成镜像</span></span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p>容器的状态</p>
<p>&nbsp;</p>
<ul>
<li><p>Created（新建）、Up（运行中）、Pause（暂停）、Exited（退出）<br>&nbsp;<br>docker hub的一个镜像的完整路径<br>&nbsp;</p>
</li>
<li><p>对于官方镜像：docker.io/library/仓库名/标签</p>
</li>
<li><p>对于非官方镜像：docker.io/仓库名/标签</p>
</li>
</ul>
<p>&nbsp;<br>推送镜像的过程：<br>&nbsp;</p>
<ul>
<li><p>注册docker hub并登录</p>
</li>
<li><p>可以创建一个仓库，选为public  </p>
</li>
<li><p>登录远程docker仓库 ，docker login，输入用户名和密码。（判断是否登录<code>cat ~/.docker/config.json</code>  有 auth的值说明登录了  ）</p>
</li>
<li>给需要上传的镜像改名为：你的用户名/镜像名/标签，即docker tag 镜像名/标签 你的用户名/镜像名/标签</li>
<li>docker push docker.io/带用户名的镜像名/标签（docker.io/可以省略）</li>
</ul>
<p>&nbsp;<br>制作镜像的过程：<br>&nbsp;</p>
<ul>
<li>新建Dockerfile文件</li>
<li>编写docker file中的内容</li>
<li><code>docker build</code>构建镜像</li>
</ul>
<p>&nbsp;<br>例如：<br>&nbsp;<br>Dockerfile的内容：<br>&nbsp;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FROM busybox</span><br><span class="line">ping baidu.com</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p>构建镜像的命令：</p>
<p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t mybusy66:v6 -f Dockerfile ./</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h3 id="2、典型命令"><a href="#2、典型命令" class="headerlink" title="2、典型命令"></a>2、典型命令</h3><p>&nbsp;</p>
<h4 id="1、docker-run"><a href="#1、docker-run" class="headerlink" title="1、docker run"></a>1、docker run</h4><p>&nbsp;<br>常用关键参数 OPTIONS 说明：<br>&nbsp;</p>
<ul>
<li><code>-d</code>: 后台运行容器，并返回容器ID；</li>
<li><code>-i</code>: 以交互模式运行容器，通常与 -t 同时使用；</li>
<li><code>-P</code>: 随机端口映射，容器内部端口随机映射到主机的端口</li>
<li><code>-p</code>:指定端口映射，格式为：主机(宿主)端口:容器端口</li>
<li><code>-t</code>: 为容器重新分配一个伪输入终端，通常与 -i 同时使用</li>
<li><code>--name=&quot;nginx-lb&quot;</code>:为容器指定一个名称；</li>
<li><code>--dns 8.8.8.8</code>: 指定容器使用的DNS服务器，默认和宿主一致；</li>
<li><code>--dns-search example.com</code>: 指定容器DNS搜索域名，默认和宿主一致；</li>
<li><code>-h &quot;mars&quot;</code>: 指定容器的hostname；</li>
<li><code>-e username=&quot;ritchie&quot;</code>: 设置环境变量；</li>
<li><code>--env-file=[]</code>: 从指定文件读入环境变量；</li>
<li><code>--cpuset=&quot;0-2&quot; or --cpuset=&quot;0,1,2&quot;</code>: 绑定容器到指定CPU运行；</li>
<li><code>-m</code>:设置容器使用内存最大值；</li>
<li><code>--net=&quot;bridge&quot;</code>: 指定容器的网络连接类型，支持 bridge/host/none/container: 四种类型；</li>
<li><code>--link=[]</code>: 添加链接到另一个容器；</li>
<li><code>--expose=[]</code>: 开放一个端口或一组端口；</li>
<li><code>--restart</code>, 指定重启策略，可以写—restart=awlays 总是故障重启</li>
<li><code>--volume</code> , -v: 绑定一个卷。一般格式 主机文件或文件夹:虚拟机文件或文件夹  </li>
</ul>
<p>&nbsp;<br>使用Docker部署组件的步骤：<br>&nbsp;</p>
<ul>
<li>1、先去找组件的镜像</li>
<li>2、查看镜像文档，了解组件的可配置内容</li>
<li>3、docker run进行部署  </li>
</ul>
<p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --name myredis2 -p 6379:6379 -p 8888:6379 redis -d <span class="comment"># 虚拟机的很多端口绑定容器的一个端口是允许的，虚拟机的一个端口绑定容器的多个端口是行不通的，因为从主机端口来的数据它不知道给谁。默认是前台启动的，一般加上-d 让他后台悄悄启动</span></span><br><span class="line">docker run -d == docker create + docker start</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<p><strong>注意：</strong>直接用<code>docker run busybox</code>这个命令并不能启动busybox，这是因为busybox运行后没有阻塞进程的命令，启动后直接就退出了，也就是容器中没有人干活。<code>docker run -it busybox</code>（交互模式），<code>docker run -d busybox ping baidu.com</code>（启动后开启ping程序），这些命令才能运行。</p>
<p>&nbsp;</p>
<h5 id="1、部署Nginx"><a href="#1、部署Nginx" class="headerlink" title="1、部署Nginx"></a>1、部署Nginx</h5><p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意 外部的/nginx/conf下面的内容必须存在，否则挂载会覆盖</span></span><br><span class="line">docker run --name nginx-app \</span><br><span class="line">-v /app/nginx/html:/usr/share/nginx/html:ro \</span><br><span class="line">-v /app/nginx/conf:/etc/nginx</span><br><span class="line">-d nginx</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h5 id="2、部署MySQL"><a href="#2、部署MySQL" class="headerlink" title="2、部署MySQL"></a>2、部署MySQL</h5><p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5.7版本</span></span><br><span class="line">docker run -p 3306:3306 --name mysql57-app \</span><br><span class="line">-v /app/mysql/<span class="built_in">log</span>:/var/<span class="built_in">log</span>/mysql \</span><br><span class="line">-v /app/mysql/data:/var/lib/mysql \</span><br><span class="line">-v /app/mysql/conf:/etc/mysql/conf.d \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=123456 \</span><br><span class="line">-d mysql:5.7</span><br><span class="line"><span class="comment">#8.x版本,引入了 secure-file-priv 机制，磁盘挂载将没有权限读写data数据，所以需要将权限透传，或者chmod -R 777 /app/mysql/data</span></span><br><span class="line"><span class="comment"># --privileged 特权容器，容器内使用真正的root用户</span></span><br><span class="line">docker run -p 3306:3306 --name mysql8-app \</span><br><span class="line">-v /app/mysql/conf:/etc/mysql/conf.d \</span><br><span class="line">-v /app/mysql/<span class="built_in">log</span>:/var/<span class="built_in">log</span>/mysql \</span><br><span class="line">-v /app/mysql/data:/var/lib/mysql \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=123456 \</span><br><span class="line">--privileged \</span><br><span class="line">-d mysql</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h5 id="3、部署Redis"><a href="#3、部署Redis" class="headerlink" title="3、部署Redis"></a>3、部署Redis</h5><p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提前准备好redis.conf文件，创建好相应的文件夹。如：</span></span><br><span class="line">port 6379</span><br><span class="line">appendonly yes</span><br><span class="line"><span class="comment">#更多配置参照 https://raw.githubusercontent.com/redis/redis/6.0/redis.conf</span></span><br><span class="line">docker run -p 6379:6379 --name redis \</span><br><span class="line">-v /app/redis/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-v /app/redis/data:/data \</span><br><span class="line">-d redis:6.2.1-alpine3.13 \</span><br><span class="line">redis-server /etc/redis/redis.conf --appendonly yes</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h5 id="4、部署ElasticSearch"><a href="#4、部署ElasticSearch" class="headerlink" title="4、部署ElasticSearch"></a>4、部署ElasticSearch</h5><p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#准备文件和文件夹，并chmod -R 777 xxx</span></span><br><span class="line"><span class="comment">#配置文件内容，参照</span></span><br><span class="line">https://www.elastic.co/guide/en/elasticsearch/reference/7.5/node.name.html 搜索相</span><br><span class="line">关配置</span><br><span class="line"><span class="comment"># 考虑为什么挂载使用esconfig ...</span></span><br><span class="line">docker run --name=elasticsearch -p 9200:9200 -p 9300:9300 \</span><br><span class="line">-e <span class="string">&quot;discovery.type=single-node&quot;</span> \</span><br><span class="line">-e ES_JAVA_OPTS=<span class="string">&quot;-Xms300m -Xmx300m&quot;</span> \</span><br><span class="line">-v /app/es/data:/usr/share/elasticsearch/data \</span><br><span class="line">-v /app/es/plugins:/usr/shrae/elasticsearch/plugins \</span><br><span class="line">-v esconfig:/usr/share/elasticsearch/config \</span><br><span class="line">-d elasticsearch:7.12.0</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h5 id="5、部署Tomcat"><a href="#5、部署Tomcat" class="headerlink" title="5、部署Tomcat"></a>5、部署Tomcat</h5><p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 考虑，如果我们每次 -v 都是指定磁盘路径，是不是很麻烦？</span></span><br><span class="line">docker run --name tomcat-app -p 8080:8080 \</span><br><span class="line">-v tomcatconf:/usr/<span class="built_in">local</span>/tomcat/conf \</span><br><span class="line">-v tomcatwebapp:/usr/<span class="built_in">local</span>/tomcat/webapps \</span><br><span class="line">-d tomcat:jdk8-openjdk-slim-buster</span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h5 id="6、重启策略"><a href="#6、重启策略" class="headerlink" title="6、重启策略"></a>6、重启策略</h5><p>&nbsp;</p>
<ul>
<li>no，默认策略，在容器退出时不重启容器</li>
<li>on-failure，在容器非正常退出时（退出状态非0），才会重启容器</li>
<li>on-failure:3，在容器非正常退出时重启容器，最多重启3次</li>
<li>always，在容器退出时总是重启容器  </li>
<li>unless-stopped，在容器退出时总是重启容器，但是不考虑在Docker守护进程启动时就已经停止了的容<br>器  </li>
</ul>
<p>&nbsp;</p>
<h4 id="2、docker-exec"><a href="#2、docker-exec" class="headerlink" title="2、docker exec"></a>2、docker exec</h4><p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it -u 0:0 mynginx4 /bin/bash <span class="comment"># -i表示交互模式，-t表示新的终端 -u 0:0表示用户的属主和属组（换成--privileged表示以root身份进入容器），/bin/bash是控制台程序（可以通过exit退出bash终端）</span></span><br></pre></td></tr></table></figure><br>&nbsp;</p>
<h4 id="3、docker-create"><a href="#3、docker-create" class="headerlink" title="3、docker create"></a>3、docker create</h4><p>&nbsp;<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker create [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br><span class="line">docker create [设置项] 镜像名 [启动命令] [启动参数...]</span><br><span class="line">docker create redis <span class="comment"># 按照redis:latest镜像启动一个容器</span></span><br><span class="line">docker create --name myredis -p 6379（主机的端口）:6379（容器的端口） redis <span class="comment"># --name表示给容器起名，-p是端口绑定 （-p port1:port2） port1到port2是主机端口到容器端口的映射。</span></span><br><span class="line"></span><br><span class="line">docker start myredis <span class="comment"># 创建之后启动容器</span></span><br></pre></td></tr></table></figure></p>
<p>&nbsp;</p>

            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2022年03月16日 15:02</p>
        <p>原始链接： <a class="post-url" href="/posts/865e.html" title="Docker的基本概念和命令">http://wht6.github.io/posts/865e.html</a></p>
        <footer>
            <a href="http://wht6.github.io">
                <img src="/images/logo.png" alt="并指如刀">
                并指如刀
            </a>
        </footer>
    </div>
</div>

      
        
            
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;">赏</a>
</div>

<div id="reward" class="post-modal reward-lay">
    <a class="close" href="javascript:;" id="reward-close">×</a>
    <span class="reward-title">
        <i class="icon icon-quote-left"></i>
        请我吃糖~
        <i class="icon icon-quote-right"></i>
    </span>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/images/wechat_code.jpg" alt="打赏二维码">
        </div>
        <div class="reward-select">
            
            <label class="reward-select-item checked" data-id="wechat" data-wechat="/images/wechat_code.jpg">
                <img class="reward-select-item-wechat" src="/images/wechat.png" alt="微信">
            </label>
            
            
            <label class="reward-select-item" data-id="alipay" data-alipay="/images/alipay_code.jpg">
                <img class="reward-select-item-alipay" src="/images/alipay.png" alt="支付宝">
            </label>
            
        </div>
    </div>
</div>


        
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://wht6.github.io/posts/865e.html&title=《Docker的基本概念和命令》 — WHT&pic=/images/featureimages/58.jpg" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://wht6.github.io/posts/865e.html&title=《Docker的基本概念和命令》 — WHT&source=分享技术,分享知识,分享感悟" data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://wht6.github.io/posts/865e.html" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Docker的基本概念和命令》 — WHT&url=http://wht6.github.io/posts/865e.html&via=http://wht6.github.io" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://wht6.github.io/posts/865e.html" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://wht6.github.io/posts/865e.html" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/Docker/" class="color2">Docker</a>
      
    <a href="/tags/容器/" class="color3">容器</a>
      
  </li>

        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#01-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="post-toc-text">01|基本概念</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1%E3%80%81Docker%E6%9E%B6%E6%9E%84"><span class="post-toc-text">1、Docker架构</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2%E3%80%81Docker%E9%9A%94%E7%A6%BB%E5%8E%9F%E7%90%86"><span class="post-toc-text">2、Docker隔离原理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3%E3%80%81Docker%E5%AE%89%E8%A3%85"><span class="post-toc-text">3、Docker安装</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1%E3%80%81%E7%A7%BB%E9%99%A4%E6%97%A7%E7%89%88%E6%9C%AC"><span class="post-toc-text">　1、移除旧版本</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2%E3%80%81%E8%AE%BE%E7%BD%AEdocker-yum%E6%BA%90"><span class="post-toc-text">2、设置docker yum源</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3%E3%80%81%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0docker-engine"><span class="post-toc-text">3、安装最新docker engine</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E5%AE%9A%E7%89%88%E6%9C%ACdocker-engine"><span class="post-toc-text">4、安装指定版本docker engine</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1%E3%80%81%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85"><span class="post-toc-text">1、在线安装</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2%E3%80%81%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85"><span class="post-toc-text">2、离线安装</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#5%E3%80%81%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1"><span class="post-toc-text">5、启动服务</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6%E3%80%81%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F"><span class="post-toc-text">6、镜像加速</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#7%E3%80%81%E5%8F%AF%E8%A7%86%E5%8C%96%E7%95%8C%E9%9D%A2-Portainer"><span class="post-toc-text">7、可视化界面-Portainer</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFPortainer"><span class="post-toc-text">1、什么是Portainer</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2%E3%80%81%E5%AE%89%E8%A3%85"><span class="post-toc-text">2、安装</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#02-Docker%E5%91%BD%E4%BB%A4"><span class="post-toc-text">02|Docker命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1%E3%80%81%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="post-toc-text">1、常见命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2%E3%80%81%E5%85%B8%E5%9E%8B%E5%91%BD%E4%BB%A4"><span class="post-toc-text">2、典型命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1%E3%80%81docker-run"><span class="post-toc-text">1、docker run</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1%E3%80%81%E9%83%A8%E7%BD%B2Nginx"><span class="post-toc-text">1、部署Nginx</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2%E3%80%81%E9%83%A8%E7%BD%B2MySQL"><span class="post-toc-text">2、部署MySQL</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3%E3%80%81%E9%83%A8%E7%BD%B2Redis"><span class="post-toc-text">3、部署Redis</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#4%E3%80%81%E9%83%A8%E7%BD%B2ElasticSearch"><span class="post-toc-text">4、部署ElasticSearch</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#5%E3%80%81%E9%83%A8%E7%BD%B2Tomcat"><span class="post-toc-text">5、部署Tomcat</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#6%E3%80%81%E9%87%8D%E5%90%AF%E7%AD%96%E7%95%A5"><span class="post-toc-text">6、重启策略</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2%E3%80%81docker-exec"><span class="post-toc-text">2、docker exec</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3%E3%80%81docker-create"><span class="post-toc-text">3、docker create</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/posts/925d.html" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          道家的睡方与睡功
        
      </span>
    </a>
  
  
    <a href="/posts/b956.html" id="article-nav-older" class="article-nav-link-wrap">
      <span class="article-nav-title">bytes包与字节串操作</span>
      <i class="fa fa-hand-o-right" aria-hidden="true"></i>
    </a>
  
</nav>



    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2022 并指如刀<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "http://wht6.github.io",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/Linux/">Linux</a><a class="category-link" href="/categories/%E4%B8%AA%E4%BA%BA%E5%85%B4%E8%B6%A3/">个人兴趣</a><a class="category-link" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a><a class="category-link" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a><a class="category-link" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><a class="category-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a><a class="category-link" href="/categories/%E7%BD%91%E7%BB%9C/">网络</a><a class="category-link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Go%E8%AF%AD%E8%A8%80/" style="font-size: 20px;">Go语言</a> <a href="/tags/Python%E8%AF%AD%E8%A8%80/" style="font-size: 16.67px;">Python语言</a> <a href="/tags/pytorch/" style="font-size: 10px;">pytorch</a> <a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 10px;">代理</a> <a href="/tags/%E5%8C%85%E7%AE%A1%E7%90%86/" style="font-size: 10px;">包管理</a> <a href="/tags/%E5%AE%9E%E4%BE%8B%E5%88%86%E5%89%B2/" style="font-size: 13.33px;">实例分割</a> <a href="/tags/%E5%AE%B9%E5%99%A8/" style="font-size: 10px;">容器</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 13.33px;">工具</a> <a href="/tags/%E6%80%9D%E7%BB%B4/" style="font-size: 10px;">思维</a> <a href="/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" style="font-size: 16.67px;">文件系统</a> <a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 10px;">日志</a> <a href="/tags/%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" style="font-size: 10px;">权限管理</a> <a href="/tags/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/" style="font-size: 10px;">用户管理</a> <a href="/tags/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/" style="font-size: 10px;">磁盘管理</a> <a href="/tags/%E7%AE%A1%E9%81%93/" style="font-size: 10px;">管道</a> <a href="/tags/%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/" style="font-size: 10px;">系统配置</a> <a href="/tags/%E7%BD%91%E7%AB%99/" style="font-size: 10px;">网站</a> <a href="/tags/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/" style="font-size: 10px;">网站搭建</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/" style="font-size: 10px;">网络配置</a> <a href="/tags/%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/" style="font-size: 10px;">计划任务</a> <a href="/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" style="font-size: 10px;">负载均衡</a> <a href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/" style="font-size: 10px;">路由器</a> <a href="/tags/%E8%BF%9B%E7%A8%8B/" style="font-size: 10px;">进程</a> <a href="/tags/%E9%81%93%E5%AE%B6/" style="font-size: 10px;">道家</a> <a href="/tags/%E9%87%8D%E5%AE%9A%E5%90%91/" style="font-size: 10px;">重定向</a> <a href="/tags/%E9%98%BF%E9%87%8C%E4%BA%91/" style="font-size: 13.33px;">阿里云</a> <a href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" style="font-size: 10px;">高可用</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a  href="/">
                    <i class="fa fa-home"></i><span>Home</span>
                </a>
            </li>
            
            <li>
                <a  href="/archives">
                    <i class="fa fa-archive"></i><span>Archives</span>
                </a>
            </li>
            
            <li>
                <a  href="/about">
                    <i class="fa fa-user"></i><span>About</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Go%E8%AF%AD%E8%A8%80/" style="font-size: 20px;">Go语言</a> <a href="/tags/Python%E8%AF%AD%E8%A8%80/" style="font-size: 16.67px;">Python语言</a> <a href="/tags/pytorch/" style="font-size: 10px;">pytorch</a> <a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 10px;">代理</a> <a href="/tags/%E5%8C%85%E7%AE%A1%E7%90%86/" style="font-size: 10px;">包管理</a> <a href="/tags/%E5%AE%9E%E4%BE%8B%E5%88%86%E5%89%B2/" style="font-size: 13.33px;">实例分割</a> <a href="/tags/%E5%AE%B9%E5%99%A8/" style="font-size: 10px;">容器</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 13.33px;">工具</a> <a href="/tags/%E6%80%9D%E7%BB%B4/" style="font-size: 10px;">思维</a> <a href="/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" style="font-size: 16.67px;">文件系统</a> <a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 10px;">日志</a> <a href="/tags/%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" style="font-size: 10px;">权限管理</a> <a href="/tags/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/" style="font-size: 10px;">用户管理</a> <a href="/tags/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/" style="font-size: 10px;">磁盘管理</a> <a href="/tags/%E7%AE%A1%E9%81%93/" style="font-size: 10px;">管道</a> <a href="/tags/%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/" style="font-size: 10px;">系统配置</a> <a href="/tags/%E7%BD%91%E7%AB%99/" style="font-size: 10px;">网站</a> <a href="/tags/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/" style="font-size: 10px;">网站搭建</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/" style="font-size: 10px;">网络配置</a> <a href="/tags/%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/" style="font-size: 10px;">计划任务</a> <a href="/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" style="font-size: 10px;">负载均衡</a> <a href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/" style="font-size: 10px;">路由器</a> <a href="/tags/%E8%BF%9B%E7%A8%8B/" style="font-size: 10px;">进程</a> <a href="/tags/%E9%81%93%E5%AE%B6/" style="font-size: 10px;">道家</a> <a href="/tags/%E9%87%8D%E5%AE%9A%E5%90%91/" style="font-size: 10px;">重定向</a> <a href="/tags/%E9%98%BF%E9%87%8C%E4%BA%91/" style="font-size: 13.33px;">阿里云</a> <a href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" style="font-size: 10px;">高可用</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>

<script src="/js/search.js"></script>


<script src="/js/main.js"></script>



  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  
<script src="/js/particles.js"></script>








  
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  
<script src="/js/animate.js"></script>



  
<script src="/js/pop-img.js"></script>

  <script>
     $(".article-entry p img").popImg();
  </script>

  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/ Relative)","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":100,"height":180},"mobile":{"show":false},"react":{"opacityDefault":0.7}});</script></body>
</html>